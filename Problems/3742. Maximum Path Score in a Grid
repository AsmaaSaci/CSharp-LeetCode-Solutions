public class Solution {
    public int MaxPathScore(int[][] grid, int k) {
        return Helper(grid, 0, 0, k, new Dictionary<(int row, int col, int k), int>());
    }
    private int Helper(int[][] grid, int r, int c, int k, Dictionary<(int row, int col, int k), int> cache)
    {
        if (r < 0 || r >= grid.Length || c < 0 || c >= grid[0].Length || (k<=0 && grid[r][c] != 0))
        {
            return -1;
        }

        if (r == grid.Length -1 && c == grid[r].Length -1)
        {
            return grid[r][c];
        }


        k -= grid[r][c] == 0 ? 0 : 1;
        if(k<0)
            return -1;
        if(cache.ContainsKey((r, c, k)))
        {
            return cache[(r, c, k)];
        }

        
        var right = Helper(grid, r, c + 1, k, cache);
        var down = Helper(grid, r + 1, c, k, cache);


        int best = Math.Max(right, down);
        int maxProfit = best == -1 ? -1 : best + grid[r][c];
        cache[(r, c, k)] = maxProfit;

        return maxProfit;
    }
}
