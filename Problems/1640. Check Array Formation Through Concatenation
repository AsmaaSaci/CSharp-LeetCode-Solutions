public class Solution {
    public bool CanFormArray(int[] arr, int[][] pieces) {
        Dictionary<int, int> dict = new();
        int len = arr.Length;

        for(int i = 0; i < len; i++)
        {
            dict.Add(arr[i], i);
        }

        int size = 0;
        foreach(int[] p in pieces)
        {
            if(!dict.ContainsKey(p[0]))
                return false;

            if(p.Length == 1)
            {
                size++;
            }
            else
            {
                size += p.Length;
                int preIdx = dict[p[0]];
                for(int i = 1; i < p.Length; i++)
                {
                    int key = p[i];
                    if(!dict.ContainsKey(key))
                        return false;

                    if(preIdx +1 != dict[key])
                        return false;

                    preIdx = dict[key];
                }
            }
        }

        return size == len;
    }
}
