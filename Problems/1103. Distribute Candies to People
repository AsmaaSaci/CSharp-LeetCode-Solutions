public class Solution {
    public int[] DistributeCandies(int candies, int num_people) {
        int n = num_people;
        int[] res = new int[num_people];

        if(candies == 1 || num_people == 1)
            return [candies];

        int sum = (1+num_people) * num_people/2;
        int r = 0;
        while(r*n*n + sum <= candies)
        {
            candies -= (r*n*n+ sum);
            r++;
        }

        int start = r*n+1;
        for(int c = 1; c <= n; c++)
        {
            int pre = 0;
            if(r > 0)
                pre = r*c + r*(r-1)*n/2;

            int rem = Math.Min(start, candies);

            pre += rem;
            candies -= rem;
            res[c-1] = pre;
            start++;
        }

        return res;
    }
}
