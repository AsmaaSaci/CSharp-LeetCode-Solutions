public class Solution {
    public long MinMoves(int[] balance) 
    {
        int n=balance.Length;

        int[] arr=new int[n*2];

        for(int i=0;i<n;i++)
        {
            arr[i]=balance[i];
            arr[n+i]=balance[i];
        }

        List<int> lst=new List<int>();
        int start=-1;

        for(int i=0;i<arr.Length;i++)
        {
            if(arr[i]<0 && start==-1)
            {
                start=i;
            }
            else if(arr[i]<0 && lst.Count>0)
            {
                break;
            }
            else if(start>=0)
            {
                lst.Add(arr[i]);
            }
        }
      
        if(start==-1)
        {
            return 0;
        }
        int l=0;
        int r=lst.Count-1;
        long dist=1;
        long num=arr[start];
        long ans=0;
        
        while(l<=r)
        {
            long sum=(l<r)?(lst[l]+lst[r]):lst[l];
            long units=Math.Min(Math.Abs(num),sum);
            num+=units;
            ans+=dist*units;
            dist++;
            l++;
            r--;
        }
       
        return (num==0)?ans:-1;
    }
}
