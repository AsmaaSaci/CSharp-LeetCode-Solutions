public class Solution {
    public int MinimumDistance(int[] nums) {
        var dist = new Dictionary<int, SortedSet<int>>();
        var n = nums.Length;    
        for (int i = 0; i < n; i++) {
            if (!dist.ContainsKey(nums[i]))
                dist[nums[i]] = [];
            dist[nums[i]].Add(i);
        }

        int min = int.MaxValue;
        foreach (var item in dist) {
            if(item.Value.Count < 3) continue;
            var positions = item.Value.ToArray();
            n = positions.Length;
            for (int i = 2; i < n; i++)
                min = Math.Min(min,
                  Math.Abs(positions[i - 2] - positions[i - 1])
                + Math.Abs(positions[i - 1] - positions[i])
                + Math.Abs(positions[i] - positions[i - 2]));
        }
        return min == int.MaxValue ? -1 : min;
    }
}
