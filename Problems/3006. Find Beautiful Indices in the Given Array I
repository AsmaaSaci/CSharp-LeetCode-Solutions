public class Solution {
    public IList<int> BeautifulIndices(string s, string a, string b, int k) {
        int lenS = s.Length, lenA = a.Length, lenB = b.Length;
        Queue<int> AIds = new(), BIds = new();
        List<int> resIds = new();
        int uplimit = lenS - Math.Min(lenA, lenB);

        for(int i = 0; i <= uplimit; i++)
        {
            if(i + lenA <= lenS)
            {
                if(s.Substring(i, lenA) == a)
                {
                    while(BIds.Count > 0 && i-BIds.Peek() > k) // pop invalid BId
                    {
                        BIds.Dequeue();
                    }

                    if(BIds.Count > 0) // Find Valid, fill in res list
                        resIds.Add(i);
                    else
                        AIds.Enqueue(i);
                }
            }

            if(i + lenB <= lenS)
            {
                if(s.Substring(i, lenB) == b)
                {   
                    while(AIds.Count > 0 && i- AIds.Peek() > k)
                    {
                        AIds.Dequeue();
                    }

                    while(AIds.Count > 0)
                    {
                        resIds.Add(AIds.Dequeue());
                    }

                    BIds.Enqueue(i);
                }
            }

        }

        return resIds;
    }
}
