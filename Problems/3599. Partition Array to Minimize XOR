public class Solution {
    public int MinXor(int[] nums, int k) {
        int n = nums.Length;
        int[][] dp = new int[n + 1][];
        int[] pref = new int[n + 1];

        for (int i = 0; i <= n; i++)
            dp[i] = Enumerable.Repeat(int.MaxValue, k + 1).ToArray();

        for (int i = 1; i <= n; i++) {
            pref[i] = pref[i - 1] ^ nums[i - 1];
            dp[i - 1][1] = pref[i];
        }

        for (int p = 2; p <= k; p++) {
            for (int i = 1; i < n; i++) {
                int temp = int.MaxValue;
                for (int j = 0; j < i; j++) {
                    int subxor = Math.Max(dp[j][p - 1], pref[i + 1] ^ pref[j + 1]);
                    temp = Math.Min(temp, subxor);
                }
                dp[i][p] = temp;
            }
        }

        return dp[n - 1][k];
    }
}
