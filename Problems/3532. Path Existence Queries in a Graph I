public class Solution
{
    public bool[] PathExistenceQueries(int n, int[] nums, int maxDiff, int[][] queries)
    {
        int[] maxReachableIndices = new int[nums.Length];
        int maxReachable = nums.Length - 1;
        maxReachableIndices[maxReachable] = maxReachable;

        for (int i = nums.Length - 1; i >= 1; i--)
        {
            if (Math.Abs(nums[i] - nums[i - 1]) > maxDiff)
            {
                maxReachable = i - 1;
            }

            maxReachableIndices[i - 1] = maxReachable;
        }

        bool[] result = new bool[queries.Length];

        // identify the start and end as graph is bidirectional
        for (int i = 0; i < queries.Length; i++)
        {            
            int start = Math.Min(queries[i][0], queries[i][1]);
            int end = Math.Max(queries[i][0], queries[i][1]);
            result[i] = end <= maxReachableIndices[start];
        }

        return result;
    }
}
